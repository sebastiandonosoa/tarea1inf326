# Sobre Back of the Envelope

BoE, es una forma de estimar la carga que se presentará nuestro sistema en condiciones particulares. En nuestro caso, pensaremos en el peor caso, que corresponderá a cuando el sismo registrado es de gran magnitud, y a su vez, es cerca de una ciudad con muchos habitantes, donde nuestra suposición es que en estas ciudades existirán más usuarios esperando obtener información de la API. (No consideramos la publicación por parte del publisher, ya que esta será única siempre, pero los llamados a la API no). 

Una forma para determinar la carga, es determinar la cantidad de bits que la API envía por petición (nuestro caso son 65 carácteres, que si asumimos que 1 carácteres son 1 byte, tenemos 65 bytes). Además, si consideramos una sobre carga del 30% en lo que sería headers y "adornos" del mensaje, llegamos a una cantidad de aproximadamente 85 bytes por solicitud. Para finalizar, en nuestro caso en particular, si consideramos Santiago como la ciudad que más solicitudes hará, podemos estimar que se harán siete millones de solicitudes en el momento peak (población aproximada de Santiago).

# Justificación de la Arquitectura propuesta

Es posible proyectar la carga de notificaciones sobre los subscribers. Por ejemplo, si se conoce que en promedio se registran cierto número de sismos al día, basta con multiplicar esa cantidad por el número de subscribers definidos (cinco en este caso) para obtener una estimación inicial del volumen de notificaciones enviadas.
Posteriormente, se debe considerar la condición de interés de cada subscriber (radio de 500 km respecto del epicentro). Con la distribución geográfica de los sismos, puede estimarse qué proporción de los eventos resultan relevantes para cada ciudad y, en consecuencia, cuántas solicitudes adicionales al servicio HTTP se generarían en busca de información detallada.

De este modo, con parámetros relativamente simples —frecuencia de sismos, número de suscriptores, distancia de interés y tasa estimada de consultas HTTP— se puede aproximar la carga promedio del sistema. Este análisis permite, además, justificar la arquitectura propuesta: el patrón publish-subscribe desacopla a los productores de eventos de los consumidores, lo que facilita la escalabilidad ante un incremento en la cantidad de sismos o de suscriptores. Por su parte, el modelo pull empleado mediante HTTP evita transmitir información innecesaria y concentra el procesamiento solo en los casos de interés, optimizando el uso de los recursos del sistema.
